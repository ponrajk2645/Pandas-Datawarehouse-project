# connecting python to database(mysql) using driver sqlalchemy

import pandas as pd
from sqlalchemy import create_engine, text
from sqlalchemy import SQLALchemyError
try:
    user = "root"
    pw = "rohit"
    db = "ponraj"
    engine = create_engine(f"mysql+pymysql://{user}:{pw}@localhost/{db}")
except SQLALchemyError as e:
    print(f" ERROR: {e}")
except Exception as e:
    print(f" ERROR: {e}")

# sending dataframes to database using the above connection
df_orders.to_sql("orders", con = engine, if_exists = "replace", index = False)    
df_products.to_sql("products",con = engine, if_exists = "replace", index = False)    
df_customers.to_sql("customers", con = engine, if_exists = "replace", index = False)    
